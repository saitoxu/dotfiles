import java.io.*;
import java.util.*;
import jp.sf.orangesignal.csv.*;
import jp.sf.orangesignal.csv.handlers.*;

public class Analysis {
    private static final String icvrUri = "/Users/Yosuke/AdAuction/20130522analysis/icvr.csv";
    private static final String usedBudgetUri = "/Users/Yosuke/AdAuction/20130522analysis/used_budget.csv";
    private static final String outputFileUri = "/Users/Yosuke/AdAuction/20130522analysis/output.csv";
    public static void main(String[] args) {
        try {
            File file = new File(outputFileUri);
            PrintWriter pw = new PrintWriter(new BufferedWriter(new FileWriter(file)));
            CsvConfig cfg = new CsvConfig('|');
            cfg.setIgnoreEmptyLines(true);
            List<String[]> usedBudgetArray = Csv.load(new File(usedBudgetUri), cfg, new StringArrayListHandler());
            List<String[]> icvrArray = Csv.load(new File(icvrUri), cfg, new StringArrayListHandler());

            for (String[] usedBudget : usedBudgetArray) {
                for (String[] icvr : icvrArray) {
                    if (Integer.parseInt(usedBudget[2]) == Integer.parseInt(icvr[0]) && usedBudget[3].equals(icvr[3]) && Integer.parseInt(usedBudget[4]) == Integer.parseInt(icvr[2])) {
                        pw.println(usedBudget[2] + "|" + usedBudget[3] + "|" + usedBudget[4] + "|" + usedBudget[0] + "|" + usedBudget[1] + "|" + icvr[4]);
                    }
                }
            }
            pw.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
