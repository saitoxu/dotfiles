#!/bin/bash
i=1
echo "use adauction3;"
while IFS="|" read media_info path_id b w distance
do
    str="create table bid${i} select bid_id, bid from full_google_bid_log_20120629_with_bid where media_info = \"${media_info}\" and path_id = ${path_id};"
    echo $str
    str="create table winning_bid${i} select bid_id, winning_bid from impression_log_20120629_with_ad_space where media_info = \"${media_info}\" and path_id = ${path_id};"
    echo $str
    i=`expr $i + 1`
done < avg_distance.csv > create_tables.sql
